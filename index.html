<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#001a00">
<title>Atomic Fizz • Fallout Vegas Geo-Game (Real GPS)</title>

<link rel="icon" href="https://i.ibb.co/0jX7Z3K/atomic-fizz-favicon.png" type="image/png">
<link rel="apple-touch-icon" href="https://i.ibb.co/0jX7Z3K/atomic-fizz-favicon.png">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;background:#000;color:#0f0;font-family:'Share Tech Mono',monospace;}
.term{display:flex;flex-direction:column;height:100%;background:#001a00;border:4px solid #0f0;box-shadow:0 0 50px #0f0;padding:12px;position:relative;}
.term::before{content:"VAULT 777 · ATOMIC FIZZ v5.3 · 50 LOCATIONS LIVE";position:absolute;top:-16px;left:50%;transform:translateX(-50%);background:#000;padding:0 20px;font-size:13px;letter-spacing:5px;}
h1{font-size:clamp(3rem,9vw,6rem);text-shadow:0 0 40px #0f0;animation:f 2s infinite;}
button{background:transparent;border:3px solid #0f0;color:#0f0;padding:16px;font-size:1.6rem;margin:10px;border-radius:12px;box-shadow:0 0 30px #0f0;transition:.3s;letter-spacing:3px;cursor:pointer;}
button:hover{box-shadow:0 0 50px #0f0;}
button:active{background:#0f0;color:#000;transform:scale(0.95);}
button:disabled{opacity:0.3;cursor:not-allowed;box-shadow:none;}
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.98);z-index:9999;justify-content:center;align-items:center;flex-direction:column;text-align:center;padding:20px;}
.crate{width:320px;height:320px;background:#111 url('https://i.ibb.co/4p7vK3B/nuka-crate.png') center/70% no-repeat;border:8px solid #ff6200;border-radius:20px;display:flex;align-items:flex-end;justify-content:center;font-size:4rem;color:#ff6200;text-shadow:0 0 20px #f90;animation:s 0.7s infinite;}
.raid{background:#300;border:6px solid #f66;padding:30px;border-radius:20px;max-width:90vw;}
@keyframes f{0%,100%{opacity:1}50%{opacity:0.4}}
@keyframes s{0%,100%{transform:translate(0)}25%{transform:translate(-12px,12px)rotate(-6deg)}75%{transform:translate(12px,-12px)rotate(6deg)}}
@keyframes pulse{0%,100%{transform:scale(1);box-shadow:0 0 0 0 rgba(0,255,0,0.7)}50%{transform:scale(1.4);box-shadow:0 0 0 20px rgba(0,255,0,0)}}
</style>
</head>
<body>

<div class="term" id="main">
  <h1>ATOMIC FIZZ</h1>
  <p style="font-size:1.8rem;margin:10px;">50 REAL LOCATIONS • REAL GPS • ON-CHAIN CAPS</p>

  <button id="connectBtn">CONNECT WALLET</button>
  <div id="status" style="margin:20px;font-size:1.5rem;">Status: <span style="color:#f66;">NOT CONNECTED</span></div>

  <div style="background:#003300;padding:15px;margin:15px 0;border-left:5px solid #0f0;border-radius:10px;">
    LVL <span id="lvl">1</span> • HP <span id="hp">100/100</span> • CAPS <span id="caps">0</span>
  </div>

  <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;">
    <button id="scannerBtn" disabled>REAL GPS SCANNER</button>
    <button id="inventoryBtn" disabled>INVENTORY</button>
  </div>
</div>

<!-- OVERLAYS (same as before) -->
<div class="overlay" id="lootOverlay"><div class="crate">LOOT</div><h2 id="lootMsg" style="margin:20px;font-size:2rem;"></h2><button onclick="closeLoot()">CLAIM & CLOSE</button></div>
<div class="overlay raid" id="raidOverlay"><h2 id="enemyName" style="color:#f66;">RAIDERS</h2><p id="enemyHp">HP: 80</p><button onclick="fight()">FIGHT</button><button onclick="flee()">FLEE</button></div>
<div class="overlay" id="inventoryOverlay"><h2>INVENTORY</h2><div id="gearList" style="margin:20px 0;font-size:1.4rem;line-height:2;"></div><div style="margin:20px 0;font-size:1.5rem;">Stimpaks: <span id="stimCount">0</span></div><button onclick="closeInv()">CLOSE</button></div>

<div id="mapContainer" style="position:fixed;inset:0;display:none;z-index:1;background:#000;">
  <div id="map" style="width:100%;height:100%;"></div>
  <button onclick="backToMain()" style="position:absolute;top:20px;left:20px;z-index:9999;padding:15px 30px;background:#f00;color:#fff;font-size:1.5rem;border:4px solid #f66;box-shadow:0 0 30px #f66;">« BACK TO VAULT</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/ethers@6.13.2/dist/ethers.umd.min.js"></script>

<script>
// GLOBALS
let map, playerMarker, watchId, markers = {};
let player = { lat:36.1146, lng:-115.1728, hp:100, maxHp:100, lvl:1, caps:0, stimpaks:0, gear:[] };
let claimed = new Set();
let currentEnemy = null;
let provider = null;
let userAddress = "";
const PROXIMITY = 120;

// 50 REAL LOCATIONS — NOW COMPLETE!
const locations = [
  {n:"Goodsprings (Pioneer Saloon)",lat:35.8324,lng:-115.4320},
  {n:"Primm (Buffalo Bill's)",lat:35.6145,lng:-115.3845},
  {n:"Nipton Trading Post",lat:35.46667,lng:-115.27222},
  {n:"Boulder City Hotel",lat:35.97750,lng:-114.83639},
  {n:"Hoover Dam",lat:36.016045,lng:-114.737839},
  {n:"Lucky 38 (The Strat)",lat:36.147247,lng:-115.156029},
  {n:"New Vegas Strip (Bellagio Fountains)",lat:36.112740,lng:-115.174301},
  {n:"Freeside (Fremont Street)",lat:36.170719,lng:-115.143929},
  {n:"Red Rock Canyon",lat:36.13514,lng:-115.4283},
  {n:"Bonnie Springs Ranch",lat:36.06007,lng:-115.45027},
  {n:"Callville Bay",lat:36.14400,lng:-114.72200},
  {n:"Black Mountain",lat:35.9310,lng:-115.0440},
  {n:"Sloan (Quarry)",lat:35.94361,lng:-115.21722},
  {n:"Jean (Airport & Prison)",lat:35.7677,lng:-115.3245},
  {n:"Searchlight",lat:35.46434,lng:-114.91844},
  {n:"McCarran Airport",lat:36.0801,lng:-115.1522},
  {n:"Nellis Air Force Base",lat:36.2361,lng:-115.0342},
  {n:"Helios One (Solar Plant)",lat:35.7580,lng:-114.9530},
  {n:"Old Mormon Fort",lat:36.1694,lng:-115.1305},
  {n:"Ultra-Luxe (Caesars Palace)",lat:36.0972,lng:-115.1787},
  {n:"Gomorrah (Old Dunes Site)",lat:36.1100,lng:-115.1720},
  {n:"Silver Rush (Golden Nugget)",lat:36.1498,lng:-115.1390},
  {n:"Atomic Wrangler (Vegas Vic)",lat:36.1499,lng:-115.1383},
  {n:"Repconn Test Site (PEPCON)",lat:36.0360,lng:-115.0880},
  {n:"Novac (Little A'Le'Inn)",lat:37.6447,lng:-115.7461},
  {n:"Nelson",lat:35.4189,lng:-114.7133},
  {n:"Rhyolite Ghost Town",lat:36.9033,lng:-116.8283},
  {n:"Mt. Charleston Lodge",lat:36.2650,lng:-115.6500},
  {n:"Luxor Pyramid",lat:36.0965,lng:-115.1769},
  {n:"Whiskey Pete's",lat:35.6167,lng:-115.3900},
  {n:"Area 51 Back Gate",lat:37.2431,lng:-115.7930},
  {n:"The Tops Casino (The D)",lat:36.1434,lng:-115.1595},
  {n:"Westside (Mormon Fort Area)",lat:36.1605,lng:-115.1612},
  {n:"Vault 21 (Las Vegas Club)",lat:36.1711,lng:-115.1435},
  {n:"Camp Golf (Boulder Beach)",lat:36.0283,lng:-114.7897},
  {n:"Cottonwood Cove",lat:35.4964,lng:-114.6842},
  {n:"188 Trading Post",lat:35.7892,lng:-115.4081},
  {n:"El Dorado Dry Lake",lat:35.7350,lng:-115.4500},
  {n:"Sunrise Mountain",lat:36.2300,lng:-115.0000},
  {n:"Vault 3 (Westside Sewers)",lat:36.1590,lng:-115.1680},
  {n:"REPCONN Headquarters",lat:36.1105,lng:-115.0050},
  {n:"Aerotech Office Park",lat:36.0878,lng:-115.0822},
  {n:"Bitter Springs",lat:36.6500,lng:-114.7000},
  {n:"Jacobstown (Mt Charleston)",lat:36.2590,lng:-115.6420},
  {n:"The Fort (Fortification Hill)",lat:35.9500,lng:-114.7500},
  {n:"Vault 22 (UNLV Area)",lat:36.1080,lng:-115.1400},
  {n:"Camp McCarran Terminal",lat:36.0820,lng:-115.1620},
  {n:"Sunset Sarsaparilla HQ",lat:36.1300,lng:-115.2200},
  {n:"Lucky Jim Mine",lat:36.4000,lng:-115.8000},
  {n:"Vault 34 (North Vegas)",lat:36.1900,lng:-115.1400}
];

// rest of your perfect code below (wallet connect, gameplay, etc.) — unchanged
// (exactly the same as your last version — just with 50 locations now!)

document.getElementById("connectBtn").onclick = async () => {
  if (window.solana && window.solana.isPhantom) {
    try { await window.solana.connect({ onlyIfTrusted: false }); userAddress = window.solana.publicKey.toString(); provider = "Phantom"; success(); return; } catch(e) {}
  }
  if (window.ethereum) {
    try {
      const accounts = await window.ethereum.request({ method: "eth_requestAccounts" });
      if (accounts.length > 0) { userAddress = accounts[0]; provider = window.ethereum.isMetaMask ? "MetaMask" : "Wallet"; success(); return; }
    } catch (e) => {
      if (e.code === 4001) alert("Connection rejected!");
      else alert("Wallet error: " + e.message);
    }
  }
  alert("No wallet → DEMO mode (full gameplay)");
  userAddress = "demo_player";
  provider = "Demo";
  success();
};

function success() {
  document.getElementById("status").innerHTML = `<span style="color:#0f0;">${provider} CONNECTED</span><br><small>${userAddress.slice(0,8)}...${userAddress.slice(-6)}</small>`;
  document.getElementById("connectBtn").textContent = "CONNECTED";
  document.getElementById("connectBtn").disabled = true;
  document.getElementById("scannerBtn").disabled = false;
  document.getElementById("inventoryBtn").disabled = false;
}

// ← All your existing functions (startGPS, claimLoot, fight, etc.) stay exactly the same → just copy them from your previous version

</script>
</body>
</html>
