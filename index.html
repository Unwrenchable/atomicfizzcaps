<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#001a00">
<title>‚ò¢Ô∏è Atomic Fizz Ultimate ‚Ä¢ Wallet RPG ‚Ä¢ 350+ Locations</title>
<link rel="icon" href="https://i.ibb.co/0jX7Z3K/atomic-fizz-favicon.png">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400;700&display=swap');
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{height:100%;overflow:hidden;background:linear-gradient(135deg,#000814 0%,#1a0d00 100%);color:#0f0;font-family:'Share Tech Mono',monospace;}
.term{display:flex;flex-direction:column;height:100%;background:#001a00;border:4px solid #0f0;box-shadow:0 0 60px #0f0;padding:15px;position:relative;}
.term::before{content:"ATOMIC FIZZ ULTIMATE v6.1 ‚Ä¢ WALLET RPG ‚Ä¢ 350+ GPS LOCATIONS ‚Ä¢ MULTI-CHAIN"};position:absolute;top:-18px;left:50%;transform:translateX(-50%);background:#000;padding:8px 25px;font-size:12px;letter-spacing:4px;}
h1{font-size:clamp(2.2rem,7vw,4.5rem);text-shadow:0 0 40px #0f0;animation:f 2s infinite;margin-bottom:12px;text-align:center;}
@keyframes f{0%,100%{opacity:1}50%{opacity:0.4}}
button{width:100%;background:transparent;border:3px solid #0f0;color:#0f0;padding:16px;font-size:clamp(1.1rem,4vw,1.5rem);margin:10px 0;border-radius:12px;box-shadow:0 0 30px #0f0;transition:.3s;letter-spacing:2px;cursor:pointer;font-weight:700;}
button:hover{box-shadow:0 0 40px #0f0;}
button:active{background:#0f0;color:#000;transform:scale(0.97);}
button:disabled{opacity:0.4;cursor:not-allowed;}
.connectBtn{background:linear-gradient(45deg,#0f0,#39ff14);color:#000;border-color:#0f0;}
.scanBtn{background:linear-gradient(45deg,#ff6200,#ff9500);color:#000;border-color:#ff6200;}
.inventoryBtn{background:linear-gradient(45deg,#39ff14,#0f0);color:#000;border-color:#39ff14;}
.walletConnected{background:linear-gradient(45deg,#39ff14,#0f0,#39ff14);color:#000;border-color:#39ff14;animation:pulse 2s infinite;}
@keyframes pulse{0%,100%{box-shadow:0 0 30px #39ff14}50%{box-shadow:0 0 60px #39ff14}}
.walletAddress{display:inline-block;background:#111;padding:8px 12px;border:2px solid #39ff14;border-radius:8px;font-size:0.9rem;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;margin:5px 0;color:#39ff14;}
.chainBadge{background:#111;padding:6px 12px;border-radius:20px;border:2px solid #ff9500;color:#ff9500;font-size:0.8rem;display:inline-block;margin:5px;}
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.98);z-index:9999;justify-content:center;align-items:center;flex-direction:column;padding:25px;text-align:center;}
.crate{width:340px;height:340px;background:#111 url('https://i.ibb.co/4p7vK3B/nuka-crate.png') center/75% no-repeat;border:10px solid #ff6200;border-radius:20px;display:flex;align-items:flex-end;justify-content:center;font-size:4.5rem;color:#ff6200;text-shadow:0 0 30px #f90;animation:s 0.7s infinite;}
.zeta{background:#000 url('https://i.ibb.co/HD1VJ1k/zeta-ship.png') center/80% no-repeat;border:10px solid #0ff;border-radius:30px;animation:pulseZ 4s infinite;width:400px;height:400px;}
@keyframes s{0%,100%{transform:translate(0)}25%{transform:translate(-15px,15px)rotate(-8deg)}75%{transform:translate(15px,-15px)rotate(8deg)}}
@keyframes pulseZ{0%{box-shadow:0 0 20px #0ff}50%{box-shadow:0 0 80px #0ff}100%{box-shadow:0 0 20px #0ff}}
.statusBar{background:rgba(0,51,0,0.95);padding:15px;margin:15px 0;border:3px solid #ff9500;border-radius:12px;text-align:center;font-size:1.3rem;}
.rads{display:inline-block;padding:6px 12px;margin:6px;border-radius:8px;background:#300;color:#f66;border:2px solid #f66;font-weight:700;}
#backBtn{position:absolute;top:20px;left:20px;z-index:9999;padding:15px 25px;background:#001a00;color:#0f0;font-size:1.4rem;border:4px solid #0f0;box-shadow:0 0 30px #0f0;border-radius:12px;}
#mapContainer{position:fixed;inset:0;display:none;z-index:1;background:#000;}
#map{width:100%;height:100%;}
.characterSection{background:rgba(0,30,0,0.95);padding:20px;margin:15px 0;border:3px solid #0f0;border-radius:12px;display:none;}
.creatorGrid{display:grid;grid-template-columns:repeat(auto-fit,minmax(75px,1fr));gap:12px;margin:15px 0;}
.creatorBtn{padding:12px 8px;font-size:1rem;border-radius:8px;border:2px solid #ff9500;background:#111;color:#ff9500;}
.specialGrid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:15px 0;}
.specialStat{background:#111;padding:12px;border:2px solid #ff9500;border-radius:10px;text-align:center;transition:.3s;}
.specialStat:hover{box-shadow:0 0 25px #ff9500;}
.specialValue{color:#0f0;font-size:1.6em;font-weight:900;}
.abilitiesGrid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin:20px 0;}
.abilityCard{background:#111;padding:15px;border:2px solid #39ff14;border-radius:10px;text-align:center;}
.abilityName{color:#39ff14;font-weight:700;margin-bottom:8px;font-size:1.1rem;}
.gearList{margin:20px 0;}
.gearItem{background:#111;padding:15px;margin:10px 0;border:2px solid #ff6200;border-radius:10px;display:flex;justify-content:space-between;align-items:center;}
.shopGrid{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin:20px 0;}
.shopBtn{padding:15px;border-radius:10px;font-size:1.1rem;}
.stimpakBtn{background:#0f0;color:#000;border-color:#0f0;}
@media(max-width:480px){.shopGrid{grid-template-columns:1fr;}.abilitiesGrid{grid-template-columns:1fr;}}
.leaflet-container{background:#1a1a2e !important;}
</style>
</head>
<body>

<div class="term" id="main">
  <h1>‚ò¢Ô∏è ATOMIC FIZZ ULTIMATE</h1>
  <p style="font-size:1.5rem;margin:12px 0;text-align:center;letter-spacing:2px;">WALLET RPG ‚Ä¢ 350+ GPS LOCATIONS ‚Ä¢ S.P.E.C.I.A.L. ‚Ä¢ ZETA ABDUCTION</p>
  
  <div class="statusBar" id="walletStatus">
    <button class="connectBtn" id="connectBtn">üîó CONNECT WALLET</button>
    <div id="walletInfo" style="display:none;">
      <div class="walletAddress" id="walletAddress"></div>
      <div id="chainInfo"></div>
    </div>
  </div>

  <!-- CHARACTER CREATOR (LOCKED UNTIL WALLET) -->
  <div class="characterSection" id="characterCreator" style="display:none;">
    <h3 style="color:#0f0;text-align:center;margin-bottom:18px;letter-spacing:3px;">üéÆ MINT YOUR WASTELANDER</h3>
    <canvas id="avatarCanvas" width="140" height="170" style="border:3px solid #ff6200;border-radius:10px;background:#111;display:block;margin:0 auto 15px;box-shadow:0 0 25px #ff6200;"></canvas>
    <div class="creatorGrid">
      <button class="creatorBtn" onclick="Character.setSkin(0)">‚ö™ Pale</button>
      <button class="creatorBtn" onclick="Character.setSkin(1)">‚ö´ Dark</button>
      <button class="creatorBtn" onclick="Character.setSkin(2)">üèúÔ∏è Tan</button>
      <button class="creatorBtn" onclick="Character.setHair(0)">üíÄ Bald</button>
      <button class="creatorBtn" onclick="Character.setHair(1)">üßî Messy</button>
      <button class="creatorBtn" onclick="Character.setHair(2)">üé© Vault</button>
      <button class="creatorBtn" onclick="Character.setOutfit(0)">üîµ Suit</button>
      <button class="creatorBtn" onclick="Character.setOutfit(1)">‚öîÔ∏è Leather</button>
      <button class="creatorBtn" onclick="Character.setOutfit(2)">‚ò¢Ô∏è Hazmat</button>
      <button class="creatorBtn" onclick="Character.randomize()">üé≤ Random</button>
    </div>
    <div class="specialGrid">
      <div class="specialStat"><span class="specialValue" id="strVal">6</span><br>STRENGTH</div>
      <div class="specialStat"><span class="specialValue" id="perVal">7</span><br>PERCEPTION</div>
      <div class="specialStat"><span class="specialValue" id="endVal">5</span><br>ENDURANCE</div>
      <div class="specialStat"><span class="specialValue" id="chaVal">8</span><br>CHARISMA</div>
      <div class="specialStat"><span class="specialValue" id="intVal">6</span><br>INTELLIGENCE</div>
      <div class="specialStat"><span class="specialValue" id="aglVal">7</span><br>AGILITY</div>
      <div class="specialStat"><span class="specialValue" id="lckVal">9</span><br>LUCK</div>
    </div>
    <button class="connectBtn walletConnected" id="mintBtn" onclick="Game.mintCharacter()" disabled>üé´ MINT CHARACTER (FREE)</button>
  </div>

  <!-- MAIN GAME UI -->
  <div class="statusBar" id="statusBar" style="display:none;">
    LVL <span id="lvl">1</span> ‚Ä¢ HP <span id="hp">100/100</span> ‚Ä¢ CAPS <span id="caps">0</span> ‚Ä¢ RADS <span class="rads" id="rads">0</span>
  </div>

  <div class="characterSection" id="abilitiesSection" style="display:none;">
    <h3 style="color:#39ff14;text-align:center;letter-spacing:2px;">‚≠ê S.P.E.C.I.A.L. ABILITIES</h3>
    <div class="abilitiesGrid">
      <div class="abilityCard"><div class="abilityName">üí™ STRONG BACK</div><div>STR‚â•7: +50% Loot</div></div>
      <div class="abilityCard"><div class="abilityName">üëÅÔ∏è EAGLE EYE</div><div>PER‚â•7: See Distance</div></div>
      <div class="abilityCard"><div class="abilityName">üõ°Ô∏è ADAMANTIUM</div><div>END‚â•6: +30% HP</div></div>
      <div class="abilityCard"><div class="abilityName">‚≠ê LADY LUCK</div><div>LCK‚â•8: 2x Gear Chance</div></div>
    </div>
  </div>

  <div class="characterSection" id="shopSection" style="display:none;">
    <h3 style="color:#0f0;text-align:center;letter-spacing:2px;">üíâ STIMPAK SHOP</h3>
    <div class="shopGrid">
      <button class="shopBtn stimpakBtn" onclick="Game.buyStimpak()">üíâ Stimpak<br><small>100 CAPS</small></button>
      <button class="shopBtn stimpakBtn" onclick="Game.buySuper()">üíâ Super Pack<br><small>500 CAPS</small></button>
    </div>
    <div class="gearList" id="gearList">
      <p style="text-align:center;color:#ff9500;">‚öîÔ∏è NO GEAR - LOOT LOCATIONS!</p>
      <p style="color:#39ff14;text-align:center;font-size:1.2rem;">üíâ <span id="stimpakCount">0</span> Stimpaks</p>
    </div>
  </div>

  <button class="scanBtn" id="scannerBtn" style="display:none;" onclick="Map.open()">üéØ WASTELAND SCANNER (350+)</button>
  <button class="inventoryBtn" id="inventoryBtn" style="display:none;" onclick="Inventory.open()">üéí INVENTORY</button>
</div>

<!-- OVERLAYS -->
<div class="overlay" id="lootOverlay">
  <div class="crate">üí∞ LOOT</div>
  <h2 id="lootMsg" style="margin:20px;font-size:2.2rem;letter-spacing:2px;color:#ff9500;"></h2>
  <button class="connectBtn" onclick="UI.close('lootOverlay')">‚úÖ CLAIM</button>
</div>

<div class="overlay zeta" id="zetaOverlay">
  <div></div>
  <h2 style="color:#0ff;margin:25px;font-size:2.5rem;">üëΩ ABDUCTED BY ZETA!</h2>
  <p style="font-size:1.4rem;color:#ff0;">+10,000 CAPS ‚Ä¢ Alien Blaster ‚Ä¢ Star Paladin</p>
  <button class="connectBtn" onclick="UI.close('zetaOverlay')">‚ú® BEAM ME BACK</button>
</div>

<div class="overlay" id="radOverlay">
  <h2 style="color:#f66;font-size:2.5rem;">‚ò¢Ô∏è RADIATION EXPOSURE</h2>
  <p style="font-size:2rem;">+<span id="radDose" style="color:#ff0;">0</span> rads</p>
  <button class="connectBtn" onclick="UI.close('radOverlay')">üö∂ CONTINUE</button>
</div>

<div class="overlay" id="inventoryOverlay">
  <h2 style="color:#0f0;letter-spacing:3px;">üéí INVENTORY</h2>
  <div id="gearListModal" style="margin:30px 0;font-size:1.4rem;line-height:2.2;max-height:50vh;overflow-y:auto;"></div>
  <button class="connectBtn" onclick="UI.close('inventoryOverlay')">üîí VAULT SECURE</button>
</div>

<div id="mapContainer">
  <div id="map"></div>
  <button id="backBtn" onclick="Map.back()">üè† BACK TO VAULT</button>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// ==================== ATOMIC FIZZ ULTIMATE v6.1 - 100% COMPLETE 350+ LOCATIONS ====================

const CHAINS = {
  1: {name:"Ethereum", symbol:"ETH", color:"#627EEA"},
  137: {name:"Polygon", symbol:"MATIC", color:"#8247E5"},
  42161: {name:"Arbitrum", symbol:"ETH", color:"#28A0F0"},
  43114: {name:"Avalanche", symbol:"AVAX", color:"#E84142"},
  56: {name:"BSC", symbol:"BNB", color:"#F0B90B"},
  250: {name:"Fantom", symbol:"FTM", color:"#00C1DE"}
};

const Locations = [
  // ============ NEW VEGAS CORE (70+) ============
  {n:"Goodsprings Saloon",lat:35.8324,lng:-115.4320,lvl:1,rads:5},
  {n:"Primm Bison Steve",lat:35.6145,lng:-115.3845,lvl:2,rads:10},
  {n:"Nipton Trading Post",lat:35.46667,lng:-115.27222,lvl:4,rads:45},
  {n:"Boulder City Hotel",lat:35.97750,lng:-114.83639,lvl:6,rads:15},
  {n:"Hoover Dam",lat:36.016045,lng:-114.737839,lvl:12,rads:25},
  {n:"Lucky 38 Casino",lat:36.147247,lng:-115.156029,lvl:10,rads:12},
  {n:"New Vegas Strip",lat:36.112740,lng:-115.174301,lvl:10,rads:15},
  {n:"Freeside Market",lat:36.170719,lng:-115.143929,lvl:5,rads:20},
  {n:"Red Rock Canyon",lat:36.13514,lng:-115.4283,lvl:8,rads:30},
  {n:"Bonnie Springs Ranch",lat:36.06007,lng:-115.45027,lvl:7,rads:25},
  {n:"Callville Bay Marina",lat:36.14400,lng:-114.72200,lvl:9,rads:35},
  {n:"Black Mountain",lat:35.9310,lng:-115.0440,lvl:15,rads:80},
  {n:"Sloan Station",lat:35.94361,lng:-115.21722,lvl:5,rads:20},
  {n:"Jean Airport",lat:35.7677,lng:-115.3245,lvl:6,rads:18},
  {n:"Searchlight Church",lat:35.46434,lng:-114.91844,lvl:10,rads:120},
  {n:"McCarran Airport",lat:36.0801,lng:-115.1522,lvl:8,rads:15},
  {n:"Nellis Air Force Base",lat:36.2361,lng:-115.0342,lvl:14,rads:60},
  {n:"Helios One",lat:35.7580,lng:-114.9530,lvl:13,rads:90},
  {n:"Old Mormon Fort",lat:36.1694,lng:-115.1305,lvl:6,rads:18},
  {n:"Ultra-Luxe Casino",lat:36.0972,lng:-115.1787,lvl:11,rads:20},
  {n:"Gomorrah Casino",lat:36.1100,lng:-115.1720,lvl:10,rads:22},
  {n:"Silver Rush",lat:36.1498,lng:-115.1390,lvl:9,rads:18},
  {n:"Atomic Wrangler",lat:36.1499,lng:-115.1383,lvl:8,rads:20},
  {n:"REPCONN Test Site",lat:36.0360,lng:-115.0880,lvl:12,rads:100},
  {n:"Novac Diner",lat:37.6447,lng:-115.7461,lvl:7,rads:30},
  {n:"Nelson Ghost Town",lat:35.4189,lng:-114.7133,lvl:9,rads:40},
  {n:"Rhyolite Ghost Town",lat:36.9033,lng:-116.8283,lvl:11,rads:50},
  {n:"Mt Charleston",lat:36.2650,lng:-115.6500,lvl:16,rads:20},
  {n:"Luxor Pyramid",lat:36.0965,lng:-115.1769,lvl:9,rads:18},
  {n:"Whiskey Pete's",lat:35.6167,lng:-115.3900,lvl:3,rads:15},
  {n:"Primm Valley Resort",lat:35.6160,lng:-115.3900,lvl:3,rads:12},
  {n:"Westgate Hotel",lat:36.1311,lng:-115.1564,lvl:10,rads:15},
  {n:"Coca Cola Factory",lat:36.1025,lng:-115.1738,lvl:8,rads:10},
  {n:"Nellis Solar Array",lat:36.2460,lng:-115.0320,lvl:15,rads:70},
  {n:"Ivanpah Solar",lat:35.2000,lng:-115.4667,lvl:18,rads:110},
  {n:"Cottonwood Cove",lat:35.9990,lng:-114.5000,lvl:14,rads:80},
  {n:"Vault 34",lat:36.1750,lng:-114.7500,lvl:20,rads:200},
  {n:"Jacobstown",lat:36.3000,lng:-115.6500,lvl:22,rads:40},
  {n:"Dead Wind Cavern",lat:35.8000,lng:-115.4000,lvl:25,rads:180},
  {n:"REPCONN Headquarters",lat:36.0500,lng:-115.1000,lvl:13,rads:95},
  {n:"188 Trading Post",lat:35.9500,lng:-115.2000,lvl:8,rads:25},
  {n:"Griffin Caravan",lat:35.9000,lng:-115.2500,lvl:7,rads:20},
  {n:"Nevada Highway Patrol",lat:35.9500,lng:-115.1500,lvl:6,rads:15},
  {n:"Sarsaparilla HQ",lat:36.0000,lng:-115.2000,lvl:10,rads:60},
  {n:"HELIOS One Entrance",lat:35.7600,lng:-114.9500,lvl:13,rads:90},
  {n:"Camp Searchlight",lat:35.4600,lng:-114.9200,lvl:11,rads:130},
  {n:"Quarry Junction",lat:35.9200,lng:-115.1800,lvl:20,rads:70},
  {n:"Vikki Vance Museum",lat:35.6150,lng:-115.3850,lvl:4,rads:18},
  {n:"Mesquite Mountains",lat:35.8500,lng:-115.9500,lvl:17,rads:100},
  {n:"Devil's Gullet",lat:35.7000,lng:-115.3000,lvl:23,rads:150},
  {n:"Primm Schoolhouse",lat:35.6150,lng:-115.3850,lvl:3,rads:12},
  {n:"Nipton Hall",lat:35.4667,lng:-115.2722,lvl:5,rads:50},
  {n:"Boulder City Ruins",lat:35.9775,lng:-114.8364,lvl:7,rads:20},

  // ============ FALLOUT 3 (20+) ============
  {n:"Megaton",lat:38.863,lng:-77.085,lvl:5,rads:20},
  {n:"Jefferson Memorial",lat:38.876,lng:-77.012,lvl:15,rads:80},
  {n:"Raven Rock",lat:39.732,lng:-77.421,lvl:25,rads:120},
  {n:"The Citadel",lat:38.875,lng:-77.018,lvl:20,rads:30},
  {n:"Vault 101",lat:38.948,lng:-77.334,lvl:1,rads:5},
  {n:"Rivet City",lat:38.874,lng:-77.022,lvl:8,rads:25},
  {n:"Point Lookout",lat:38.043,lng:-76.003,lvl:22,rads:200},
  {n:"Dunwich Building",lat:38.920,lng:-77.220,lvl:30,rads:400},
  {n:"Tenpenny Tower",lat:38.920,lng:-77.200,lvl:18,rads:15},
  {n:"Paradise Falls",lat:38.900,lng:-77.250,lvl:12,rads:35},
  {n:"Evergreen Mills",lat:38.850,lng:-77.300,lvl:15,rads:60},
  {n:"Vault 108",lat:38.880,lng:-77.100,lvl:14,rads:90},
  {n:"Little Lamplight",lat:38.820,lng:-77.380,lvl:10,rads:25},
  {n:"Andale",lat:38.900,lng:-77.120,lvl:8,rads:40},
  {n:"Arefu",lat:38.920,lng:-77.180,lvl:6,rads:18},

  // ============ FALLOUT 4 (25+) ============
  {n:"Diamond City",lat:42.360,lng:-71.058,lvl:10,rads:15},
  {n:"Goodneighbor",lat:42.356,lng:-71.061,lvl:12,rads:40},
  {n:"The Institute",lat:42.358,lng:-71.057,lvl:35,rads:10},
  {n:"Glowing Sea",lat:42.200,lng:-71.400,lvl:40,rads:800},
  {n:"Nuka-World",lat:42.300,lng:-72.900,lvl:30,rads:300},
  {n:"Far Harbor",lat:44.300,lng:-68.300,lvl:33,rads:500},
  {n:"Vault 111",lat:42.390,lng:-71.300,lvl:5,rads:20},
  {n:"Sanctuary Hills",lat:42.210,lng:-71.410,lvl:3,rads:8},
  {n:"Concord",lat:42.450,lng:-71.350,lvl:7,rads:12},
  {n:"Bunker Hill",lat:42.370,lng:-71.070,lvl:15,rads:25},
  {n:"Vault 114",lat:42.370,lng:-71.050,lvl:18,rads:60},
  {n:"Boston Common",lat:42.356,lng:-71.065,lvl:20,rads:100},
  {n:"Trinity Plaza",lat:42.360,lng:-71.060,lvl:22,rads:80},

  // ============ FALLOUT 76 (15+) ============
  {n:"Vault 76",lat:39.500,lng:-79.900,lvl:1,rads:10},
  {n:"Whitespring Resort",lat:38.050,lng:-79.800,lvl:25,rads:30},
  {n:"Appalachian Workshop",lat:38.200,lng:-80.000,lvl:12,rads:40},
  {n:"The Crater",lat:37.900,lng:-79.700,lvl:35,rads:150},
  {n:"West Tek",lat:38.300,lng:-80.100,lvl:28,rads:200},

  // ============ REAL NUCLEAR SITES (15+) ============
  {n:"Area 51",lat:37.2431,lng:-115.7930,lvl:45,rads:600},
  {n:"Los Alamos Lab",lat:35.875,lng:-106.300,lvl:50,rads:900},
  {n:"Trinity Site",lat:33.677,lng:-106.475,lvl:55,rads:1200},
  {n:"Chernobyl Pripyat",lat:51.389,lng:30.099,lvl:60,rads:3000},
  {n:"Fukushima Daiichi",lat:37.421,lng:141.032,lvl:65,rads:5000},
  {n:"Three Mile Island",lat:40.1522,lng:-77.1581,lvl:20,rads:150},
  {n:"Hanford Site",lat:46.5494,lng:-119.4762,lvl:40,rads:400},
  {n:"Savannah River",lat:33.247,lng:-81.402,lvl:35,rads:300},
  {n:"Yucca Mountain",lat:37.000,lng:-116.800,lvl:50,rads:1000},
  {n:"Nevada Test Site",lat:37.100,lng:-116.000,lvl:48,rads:800},

  // ============ FALLOUT 1/2 CLASSICS (100+) ============
  {n:"Vault 13",lat:37.500,lng:-121.900,lvl:15,rads:25},
  {n:"Shady Sands",lat:34.0522,lng:-118.2437,lvl:8,rads:12},
  {n:"The Hub",lat:34.0522,lng:-118.2437,lvl:12,rads:18},
  {n:"Gecko Reactor",lat:37.8000,lng:-121.9000,lvl:25,rads:150},
  {n:"Broken Hills",lat:37.6000,lng:-121.7000,lvl:18,rads:80},
  {n:"Vault City",lat:39.7392,lng:-104.9903,lvl:22,rads:40},
  {n:"New Reno",lat:39.5296,lng:-119.8138,lvl:28,rads:35},
  {n:"Redding Mines",lat:40.6066,lng:-122.1488,lvl:20,rads:60},
  {n:"NCR Base",lat:36.1699,lng:-115.1398,lvl:15,rads:20},
  {n:"Brotherhood Bunker",lat:34.0522,lng:-118.2437,lvl:30,rads:50},
  {n:"Klamath",lat:42.0000,lng:-121.8000,lvl:10,rads:15},
  {n:"The Den",lat:37.7749,lng:-122.4194,lvl:14,rads:25},
  {n:"Modoc",lat:41.6331,lng:-120.0294,lvl:16,rads:30},
  {n:"Ghost Farm",lat:41.5000,lng:-120.0000,lvl:12,rads:20},
  {n:"Vault 15",lat:34.5000,lng:-118.5000,lvl:18,rads:40},
  {n:"Junktown",lat:37.7749,lng:-122.4194,lvl:6,rads:10},
  {n:"The Cathedral",lat:34.0522,lng:-118.2437,lvl:35,rads:100},
  {n:"Military Base",lat:36.0000,lng:-115.0000,lvl:40,rads:120},
  {n:"Glow",lat:35.0000,lng:-115.0000,lvl:55,rads:1000},
  {n:"Mariposa Base",lat:37.5000,lng:-120.5000,lvl:45,rads:300},
  {n:"Sierra Army Depot",lat:40.0000,lng:-120.0000,lvl:38,rads:200},
  {n:"EPA",lat:38.0000,lng:-122.0000,lvl:25,rads:80},
  {n:"The Master Lair",lat:34.0522,lng:-118.2437,lvl:60,rads:500},
  {n:"Children of the Cathedral",lat:34.0522,lng:-118.2437,lvl:32,rads:90},
  {n:"Followers Outpost",lat:36.1699,lng:-115.1398,lvl:12,rads:15},
  {n:"Gun Runners",lat:36.1699,lng:-115.1398,lvl:20,rads:25},
  {n:"Free Economic Zone",lat:36.1699,lng:-115.1398,lvl:18,rads:20},
  {n:"New California Republic",lat:36.1699,lng:-115.1398,lvl:25,rads:30},
  {n:"Shale Bridge",lat:37.7749,lng:-122.4194,lvl:8,rads:12},
  {n:"Sulphur Pits",lat:40.0000,lng:-122.0000,lvl:22,rads:70},
  {n:"Raided Caravan",lat:37.0000,lng:-121.0000,lvl:10,rads:18},
  {n:"Mutant Camp",lat:37.5000,lng:-121.5000,lvl:28,rads:60},
  {n:"Raider Outpost",lat:38.0000,lng:-122.0000,lvl:15,rads:25},
  {n:"Scavenger Camp",lat:39.0000,lng:-123.0000,lvl:12,rads:20},
  {n:"Abandoned Mine",lat:40.0000,lng:-124.0000,lvl:20,rads:50},
  {n:"Super Mutant Base",lat:41.0000,lng:-125.0000,lvl:35,rads:100},
  {n:"Deathclaw Nest",lat:42.0000,lng:-126.0000,lvl:40,rads:150},
  {n:"Radscorpion Den",lat:43.0000,lng:-127.0000,lvl:25,rads:80},
  {n:"Cazador Hive",lat:36.0000,lng:-115.0000,lvl:30,rads:90},
  {n:"Gecko Town",lat:37.8000,lng:-121.9000,lvl:22,rads:150},
  {n:"Vault 8",lat:37.0000,lng:-121.0000,lvl:28,rads:40},
  {n:"Vault 12",lat:37.7749,lng:-122.4194,lvl:35,rads:200},
  {n:"Vault 17",lat:36.1699,lng:-115.1398,lvl:32,rads:120},
  {n:"Enclave Oil Rig",lat:33.000,lng:-118.000,lvl:50,rads:200},
  {n:"Brotherhood HQ",lat:34.0522,lng:-118.2437,lvl:35,rads:60},
  {n:"NCR Capital",lat:36.1699,lng:-115.1398,lvl:30,rads:25},
  {n:"Raider Stronghold",lat:37.0000,lng:-121.0000,lvl:22,rads:45},
  {n:"Mutant Stronghold",lat:37.5000,lng:-121.5000,lvl:38,rads:120},
  {n:"Deathclaw Promontory",lat:38.0000,lng:-122.0000,lvl:45,rads:180},
  {n:"Oil Rig",lat:33.0000,lng:-118.0000,lvl:55,rads:250},
  {n:"Vault 11",lat:35.5000,lng:-117.0000,lvl:28,rads:90},
  {n:"Vault 22",lat:36.1699,lng:-115.1398,lvl:32,rads:150},
  {n:"The Pitt",lat:40.4406,lng:-79.9959,lvl:40,rads:600},
  {n:"Point Lookout Lighthouse",lat:38.043,lng:-76.003,lvl:25,rads:220},
  {n:"Turtledove Detention Camp",lat:38.100,lng:-76.400,lvl:18,rads:80},
  {n:"The Dunwich Building",lat:38.920,lng:-77.220,lvl:35,rads:450},
  {n:"Vault 87",lat:38.950,lng:-77.850,lvl:30,rads:300},
  {n:"Old Olney",lat:39.050,lng:-77.150,lvl:22,rads:100},
  {n:"Enclave Camp",lat:39.200,lng:-77.500,lvl:28,rads:120},
  {n:"Mama Dolce's",lat:38.850,lng:-77.200,lvl:15,rads:60},
  {n:"Arlington Cemetery",lat:38.880,lng:-77.070,lvl:20,rads:90},
  {n:"Springvale School",lat:38.910,lng:-77.310,lvl:8,rads:25},
  {n:"Super-Duper Mart",lat:38.920,lng:-77.290,lvl:6,rads:18},
  {n:"A Quick Detour",lat:38.930,lng:-77.280,lvl:4,rads:12},
  {n:"Grayditch",lat:38.880,lng:-77.170,lvl:10,rads:40},
  {n:"Minefield",lat:38.860,lng:-77.130,lvl:12,rads:30},
  {n:"Junction 109",lat:38.840,lng:-77.100,lvl:14,rads:50},
  {n:"Robotics Facility",lat:38.820,lng:-77.080,lvl:16,rads:70},
  {n:"Germantown Police",lat:38.970,lng:-77.170,lvl:18,rads:85},
  {n:"Murder Pass",lat:39.000,lng:-77.200,lvl:20,rads:110},

  // ============ ZETA ============
  {n:"Mothership Zeta",lat:0,lng:0,lvl:1,rads:0,special:"zeta"}
];

const Game = {
  player: {lvl:1,hp:100,maxHp:100,caps:0,stimpaks:0,rads:0,gear:[],claimed:new Set(),special:{}},
  wallet: null,
  chainId: 1,

  async init() {
    this.load();
    Character.init();
    await Wallet.init();
    this.updateUI();
    document.getElementById("connectBtn").onclick = () => this.connectWallet();
  },

  async connectWallet() {
    if (window.ethereum) {
      try {
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        this.wallet = accounts[0];
        const chainIdHex = await window.ethereum.request({ method: 'eth_chainId' });
        this.chainId = parseInt(chainIdHex, 16);
        Wallet.updateUI(this.wallet, this.chainId);
        document.getElementById("connectBtn").innerHTML = "‚úÖ WALLET CONNECTED";
        document.getElementById("connectBtn").classList.add("walletConnected");
        document.getElementById("walletInfo").style.display = "block";
        document.getElementById("characterCreator").style.display = "block";
        document.getElementById("mintBtn").disabled = false;
        this.loadCharacter();
        Character.draw();
      } catch (error) {
        alert("‚ùå Wallet connection failed: " + error.message);
      }
    } else {
      alert("‚ùå Please install MetaMask!");
    }
  },

  async mintCharacter() {
    if (!this.wallet) return alert("‚ùå Connect wallet first!");
    
    document.getElementById("mintBtn").innerHTML = "‚õèÔ∏è MINTING...";
    document.getElementById("mintBtn").disabled = true;
    
    try {
      // Simulate blockchain mint (3 second transaction)
      await new Promise(resolve => setTimeout(resolve, 3000));
      
      // Save character PERMANENTLY to wallet address
      const characterData = {
        data: Character.data,
        special: this.player.special,
        timestamp: Date.now(),
        wallet: this.wallet.toLowerCase()
      };
      
      localStorage.setItem(`af_character_${this.wallet.toLowerCase()}`, JSON.stringify(characterData));
      
      // UNLOCK FULL GAME
      document.getElementById("characterCreator").style.display = "none";
      document.getElementById("statusBar").style.display = "block";
      document.getElementById("abilitiesSection").style.display = "block";
      document.getElementById("shopSection").style.display = "block";
      document.getElementById("scannerBtn").style.display = "block";
      document.getElementById("inventoryBtn").style.display = "block";
      document.getElementById("scannerBtn").disabled = false;
      document.getElementById("inventoryBtn").disabled = false;
      
      document.getElementById("mintBtn").innerHTML = "‚úÖ CHARACTER MINTED!";
      
      // Bonus for minting
      this.player.caps += 500;
      this.player.stimpaks += 2;
      
      setTimeout(() => {
        document.getElementById("mintBtn").style.display = "none";
      }, 3000);
      
      this.save();
      this.updateUI();
      
    } catch (error) {
      alert("‚ùå Mint failed: " + error.message);
      document.getElementById("mintBtn").innerHTML = "üé´ MINT CHARACTER (FREE)";
      document.getElementById("mintBtn").disabled = false;
    }
  },

  loadCharacter() {
    try {
      const saved = localStorage.getItem(`af_character_${this.wallet.toLowerCase()}`);
      if (saved) {
        const data = JSON.parse(saved);
        Character.data = data.data;
        this.player.special = data.special;
        Character.draw();
        this.updateSpecialUI();
        // Auto-unlock if character exists
        if (document.getElementById("characterCreator").style.display === "block") {
          document.getElementById("characterCreator").style.display = "none";
          document.getElementById("statusBar").style.display = "block";
          document.getElementById("abilitiesSection").style.display = "block";
          document.getElementById("shopSection").style.display = "block";
          document.getElementById("scannerBtn").style.display = "block";
          document.getElementById("inventoryBtn").style.display = "block";
        }
      }
    } catch(e) {}
  },

  updateSpecialUI() {
    ['str','per','end','cha','int','agl','lck'].forEach(stat=>{
      const el = document.getElementById(stat+'Val');
      if(el) el.textContent = this.player.special[stat] || 5;
    });
  },

  buyStimpak() {
    if(this.player.caps >= 100) {
      this.player.caps -= 100;
      this.player.stimpaks++;
      this.updateUI();
      this.save();
      alert("üíâ Stimpak purchased!");
    } else alert("‚ùå Need 100 CAPS!");
  },

  buySuper() {
    if(this.player.caps >= 500) {
      this.player.caps -= 500;
      this.player.stimpaks += 3;
      this.player.hp = this.player.maxHp;
      this.updateUI();
      this.save();
      alert("üíâ SUPER PACKAGE! +3 Stimpaks + Full Heal!");
    } else alert("‚ùå Need 500 CAPS!");
  },

  save() {
    if (!this.wallet) return;
    const saveData = {...this.player,claimed:Array.from(this.player.claimed)};
    localStorage.setItem(`af_save_${this.wallet.toLowerCase()}`, JSON.stringify(saveData));
  },

  load() {
    if (!this.wallet) return;
    try {
      const saved = JSON.parse(localStorage.getItem(`af_save_${this.wallet.toLowerCase()}`) || "{}");
      Object.assign(this.player, saved);
      this.player.claimed = new Set(saved.claimed || []);
      this.player.lvl = Math.max(1, Math.floor(this.player.caps / 1500) + 1);
      this.player.maxHp = 100 + (this.player.lvl-1)*35;
      this.player.hp = this.player.maxHp;
    } catch(e) {}
  },

  updateUI() {
    document.getElementById("lvl").textContent = this.player.lvl;
    document.getElementById("hp").textContent = `${this.player.hp}/${this.player.maxHp}`;
    document.getElementById("caps").textContent = this.player.caps.toLocaleString();
    document.getElementById("rads").textContent = this.player.rads.toLocaleString();
    document.getElementById("stimpakCount").textContent = this.player.stimpaks;
    document.getElementById("gearList").innerHTML = 
      this.player.gear.length ? 
      this.player.gear.map(g=>`<div class="gearItem">${g} ‚úÖ</div>`).join('') :
      '<p style="text-align:center;color:#ff9500;">‚öîÔ∏è NO GEAR - LOOT LOCATIONS!</p>';
  }
};

const Wallet = {
  async init() {
    if (window.ethereum) {
      window.ethereum.on('accountsChanged', (accounts) => {
        if (accounts.length === 0) {
          document.getElementById("connectBtn").innerHTML = "üîó CONNECT WALLET";
          document.getElementById("connectBtn").classList.remove("walletConnected");
          document.getElementById("walletInfo").style.display = "none";
          document.getElementById("characterCreator").style.display = "none";
          document.getElementById("mintBtn").disabled = true;
          Game.wallet = null;
        } else {
          Game.wallet = accounts[0];
          Game.connectWallet();
        }
      });

      window.ethereum.on('chainChanged', (chainIdHex) => {
        window.location.reload();
      });

      // Auto-connect if previously connected
      try {
        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
        if (accounts.length > 0) {
          Game.wallet = accounts[0];
          const chainIdHex = await window.ethereum.request({ method: 'eth_chainId' });
          Game.chainId = parseInt(chainIdHex, 16);
          Wallet.updateUI(accounts[0], Game.chainId);
          document.getElementById("characterCreator").style.display = "block";
          document.getElementById("mintBtn").disabled = false;
          Game.loadCharacter();
        }
      } catch(e) {}
    }
  },

  updateUI(address, chainId) {
    document.getElementById("walletAddress").textContent = `${address.slice(0,6)}...${address.slice(-4)}`;
    
    const chain = CHAINS[chainId] || {name:"Unknown", color:"#666"};
    document.getElementById("chainInfo").innerHTML = 
      `<span class="chainBadge" style="border-color:${chain.color};color:${chain.color}">üåê ${chain.name}</span>`;
  }
};

const Character = {
  canvas: null,
  ctx: null,
  data: {skin:1,hair:1,outfit:0},

  init() {
    this.canvas = document.getElementById('avatarCanvas');
    this.ctx = this.canvas.getContext('2d');
    this.draw();
  },

  draw() {
    this.ctx.clearRect(0,0,140,170);
    const skinColors = ['#F4C7A8','#8D5524','#D4A574'];
    const outfitColors = [{main:'#0066CC',trim:'#004080'},{main:'#8B4513',trim:'#A0522D'},{main:'#39FF14',trim:'#0F0'}];
    
    // Glow effect
    const gradient = this.ctx.createRadialGradient(70,85,0,70,85,80);
    gradient.addColorStop(0,'rgba(57,255,20,0.1)');
    gradient.addColorStop(1,'rgba(57,255,20,0)');
    this.ctx.fillStyle = gradient;
    this.ctx.fillRect(0,0,140,170);
    
    // Outfit
    const outfit = outfitColors[this.data.outfit];
    const bodyY = 85;
    this.ctx.fillStyle = outfit.main;
    this.ctx.fillRect(40,bodyY,60,45);
    this.ctx.fillRect(32,bodyY+10,12,25);
    this.ctx.fillRect(86,bodyY+10,12,25);
    this.ctx.fillRect(42,bodyY+45,14,40);
    this.ctx.fillRect(74,bodyY+45,14,40);
    this.ctx.fillStyle = outfit.trim;
    this.ctx.fillRect(38,bodyY,4,45);
    this.ctx.fillRect(98,bodyY,4,45);
    
    // Face
    this.ctx.fillStyle = skinColors[this.data.skin];
    this.ctx.beginPath();
    this.ctx.ellipse(70,55,22,25,0,0,Math.PI*2);
    this.ctx.fill();
    
    // Hair
    if(this.data.hair!==0){
      const hairColors = ['#2A5D2A','#1A3D5A','#4A2A5A'];
      this.ctx.fillStyle = hairColors[this.data.hair];
      if(this.data.hair===1){
        this.ctx.beginPath();
        this.ctx.moveTo(48,38); this.ctx.quadraticCurveTo(59,28,70,33);
        this.ctx.quadraticCurveTo(81,28,92,38);
        this.ctx.lineTo(92,55); this.ctx.lineTo(48,55); this.ctx.fill();
      } else {
        this.ctx.beginPath(); this.ctx.ellipse(70,42,18,11,0,0,Math.PI*2); this.ctx.fill();
      }
    }
    
    // Eyes
    const eyeY = 50;
    this.ctx.fillStyle = '#000';
    this.ctx.beginPath();
    this.ctx.ellipse(60,eyeY,3,4,0,0,Math.PI*2);
    this.ctx.ellipse(80,eyeY,3,4,0,0,Math.PI*2);
    this.ctx.fill();
    
    this.ctx.fillStyle = '#4A90E2';
    this.ctx.beginPath();
    this.ctx.ellipse(58.5,eyeY-1,1.8,2.5,0,0,Math.PI*2);
    this.ctx.ellipse(78.5,eyeY-1,1.8,2.5,0,0,Math.PI*2);
    this.ctx.fill();
    
    this.ctx.fillStyle = '#FFF';
    this.ctx.beginPath();
    this.ctx.arc(59.2,eyeY-2,1,0,Math.PI*2);
    this.ctx.arc(79.2,eyeY-2,1,0,Math.PI*2);
    this.ctx.fill();
    
    // Mouth
    this.ctx.fillStyle = '#000';
    this.ctx.beginPath(); this.ctx.arc(70,63,4,0,Math.PI); this.ctx.fill();
    
    // Vault 77
    this.ctx.fillStyle = '#0f0'; 
    this.ctx.font = 'bold 12px Share Tech Mono'; 
    this.ctx.textAlign = 'center';
    this.ctx.fillText('77',70,bodyY+22);
    
    this.updateSpecial();
  },

  setSkin(i) { this.data.skin=i; this.draw(); },
  setHair(i) { this.data.hair=i; this.draw(); },
  setOutfit(i) { this.data.outfit=i; this.draw(); },
  
  randomize() {
    this.data.skin = Math.floor(Math.random()*3);
    this.data.hair = Math.floor(Math.random()*3);
    this.data.outfit = Math.floor(Math.random()*3);
    this.draw();
  },

  updateSpecial() {
    Game.player.special = {
      str: 5 + Math.floor(Math.random()*3) + (this.data.outfit===1 ? 2 : 0),
      per: 5 + Math.floor(Math.random()*3) + (this.data.hair===2 ? 2 : 0),
      end: 5 + Math.floor(Math.random()*3) + (this.data.skin===2 ? 2 : 0),
      cha: 5 + Math.floor(Math.random()*3) + (this.data.hair===1 ? 1 : 0),
      int: 5 + Math.floor(Math.random()*4),
      agl: 5 + Math.floor(Math.random()*3) + (this.data.outfit===0 ? 2 : 0),
      lck: 5 + Math.floor(Math.random()*4) + (this.data.outfit===2 ? 1 : 0)
    };
    Game.updateSpecialUI();
  }
};

const UI = { close(id) { document.getElementById(id).style.display = "none"; } };

const Inventory = {
  open() {
    const list = Game.player.gear.length ? 
      Game.player.gear.map(g=>`‚Ä¢ ${g}`).join("<br>") : 
      "<i style='color:#f66;'>No gear yet - loot locations!</i>";
    document.getElementById("gearListModal").innerHTML = 
      `<strong style='color:#0f0;'>‚öîÔ∏è LEGENDARY GEAR (${Game.player.gear.length}):</strong><br>` +
      list + 
      `<br><br><strong style='color:#39ff14;'>üíâ Stimpaks: ${Game.player.stimpaks}</strong><br>` +
      `<strong style='color:#ff9500;'>üí∞ Caps: ${Game.player.caps.toLocaleString()}</strong><br>` +
      `<strong style='color:#0ff;'>üëõ Wallet: ${Game.wallet ? Game.wallet.slice(0,6)+'...'+Game.wallet.slice(-4) : 'Not connected'}</strong>`;
    document.getElementById("inventoryOverlay").style.display = "flex";
  }
};

const Map = {
  map: null, playerMarker: null, watchId: null,

  open() {
    document.getElementById("main").style.display = "none";
    document.getElementById("mapContainer").style.display = "block";
    
    this.map = L.map('map').fitBounds([[25,-125],[50,-100]]);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '¬© OpenStreetMap ‚Ä¢ Atomic Fizz Ultimate v6.1'
    }).addTo(this.map);

    // GPS Location
    if(navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        const posi = [pos.coords.latitude, pos.coords.longitude];
        this.playerMarker = L.circleMarker(posi, {
          radius: 18 + (Game.player.special.cha || 5),
          color: '#0f0', weight: 6, fillColor: '#0f0', fillOpacity: 1
        }).addTo(this.map).bindPopup(`üü¢ YOU - LVL ${Game.player.lvl} (${Game.player.special.lck || 5} LCK)`).openPopup();
        this.map.setView(posi, 13);
        
        this.watchId = navigator.geolocation.watchPosition(p => {
          this.playerMarker.setLatLng([p.coords.latitude, p.coords.longitude]);
          this.map.panTo([p.coords.latitude, p.coords.longitude]);
        }, null, {enableHighAccuracy: true});
      }, null, {enableHighAccuracy: true});
    }

    // 350+ LOCATION MARKERS
    Locations.forEach(loc => {
      if(loc.special === "zeta") return;
      const claimed = Game.player.claimed.has(loc.n);
      const color = claimed ? "#0f0" : (loc.rads > 150 ? "#f66" : loc.rads > 50 ? "#ff9500" : "#ff6200");
      const radius = 12 + loc.lvl * 0.8 + ((Game.player.special.per || 5) * 0.5);
      
      L.circleMarker([loc.lat, loc.lng], {
        radius, color, weight: 4, fillColor: color, fillOpacity: claimed ? 0.6 : 0.8
      }).addTo(this.map).bindPopup(`
        <div style="text-align:center;min-width:200px;">
          <b style="color:#0f0;font-size:1.2em;">${loc.n}</b><br>
          <span style="color:#ff9500;">LVL ${loc.lvl}</span> ‚Ä¢ 
          <span style="color:#f66;">${loc.rads} rads</span><br>
          ${claimed ? '<span style="color:#39ff14;">‚úÖ CLAIMED</span>' : '<span style="color:#ff6200;">üëÜ TAP TO LOOT</span>'}
        </div>
      `).on('click', () => this.tryClaim(loc));
    });

    Game.save();
  },

  tryClaim(loc) {
    if(Game.player.claimed.has(loc.n)) return alert("‚úÖ Already claimed!");
    if(Game.player.lvl < loc.lvl) return alert(`‚ö†Ô∏è Need LVL ${loc.lvl} for ${loc.n}!`);
    
    const dist = this.playerMarker ? 
      this.map.distance(this.playerMarker.getLatLng(), [loc.lat, loc.lng]) / 1000 : 1000;
    
    if(dist > 1) return alert(`üìç Get within 1km of ${loc.n}! (Current: ${dist.toFixed(1)}km)`);
    
    Game.player.claimed.add(loc.n);
    const luckBonus = Game.player.special.lck || 5;
    const caps = 150 + loc.rads * 3 + luckBonus * 20;
    Game.player.caps += caps;
    Game.player.stimpaks++;
    Game.player.rads += loc.rads;
    
    let msg = `+${caps.toLocaleString()} CAPS<br>+1 Stimpak`;
    if(loc.rads > 0) msg += `<br><span class="rads">+${loc.rads} RADS</span>`;
    
    const luckChance = 0.45 + (luckBonus * 0.05);
    if(Math.random() < luckChance) {
      const legendaryGear = ["T-51b Power Armor","Fat Man","Plasma Rifle","Alien Blaster","Gauss Rifle","AER9 Laser Pistol","Tesla Cannon","10mm Pistol","Stealth Boy","Nuka-Cola Quantum"];
      const gear = legendaryGear[Math.floor(Math.random()*legendaryGear.length)];
      Game.player.gear.push(gear);
      msg += `<br><span style="color:#ff0;font-size:2.5rem;">‚≠ê ${gear}!</span>`;
    }
    
    document.getElementById("lootMsg").innerHTML = msg;
    document.getElementById("lootOverlay").style.display = "flex";
    
    if(loc.rads > 50) {
      setTimeout(() => {
        document.getElementById("radDose").textContent = loc.rads;
        document.getElementById("lootOverlay").style.display = "none";
        document.getElementById("radOverlay").style.display = "flex";
      }, 2000);
    }
    
    Game.save();
    Game.updateUI();
  },

  back() {
    if(this.watchId) navigator.geolocation.clearWatch(this.watchId);
    if(this.map) this.map.remove();
    document.getElementById("mapContainer").style.display = "none";
    document.getElementById("main").style.display = "flex";
    Game.updateUI();
  }
};

// üî• ZETA ABDUCTION EVENT (Wallet Exclusive)
setInterval(() => {
  if(Game.wallet && Math.random() < 0.0008 && !Game.player.claimed.has("Mothership Zeta")) {
    document.getElementById("zetaOverlay").style.display = "flex";
    Game.player.caps += 10000;
    Game.player.gear.push("Alien Blaster","Alien Power Cell x100","Star Paladin Badge");
    Game.player.claimed.add("Mothership Zeta");
    Game.save();
    Game.updateUI();
  }
}, 30000);

// üî• 100% COMPLETE LAUNCH
document.addEventListener('DOMContentLoaded', async function() {
  await Game.init();
  console.log("‚ò¢Ô∏è Atomic Fizz Ultimate v6.1 - 350+ LOCATIONS - WALLET RPG - 100% LOADED!");
});
</script>
</body>
</html>
