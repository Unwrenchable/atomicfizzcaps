<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Atomic Fizz">
<meta name="theme-color" content="#001a00">
<title>Atomic Fizz ¬∑ Vault 77 ‚Äì 50 LOCATIONS MOBILE</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono:wght@400;700&display=swap');
* {margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html, body {height:100%;overflow-y:auto;background:#000;color:#0f0;font-family:'Share Tech Mono',monospace;-webkit-user-select:none;user-select:none;}
.term {flex:1;display:flex;flex-direction:column;background:#001a00;border:3px solid #0f0;box-shadow:0 0 40px #0f0;padding:15px;border-radius:12px;position:relative;text-align:center;min-height:0;overflow-y:auto;max-height:100vh;}
.term::before {content:"VAULT 777 ¬∑ ATOMIC FIZZ ¬∑ 50 LOCATIONS v3.3 ‚úÖ";position:absolute;top:-15px;left:10px;background:#000;padding:0 15px;font-size:12px;letter-spacing:3px;}
h1 {font-size:clamp(2.5rem,6vw,4rem);margin:15px 0;text-shadow:0 0 25px #0f0;animation:f 2s infinite;}
button {background:transparent;border:2px solid #0f0;color:#0f0;padding:12px 25px;font-size:clamp(1.2rem,4vw,1.6rem);margin:10px 5px;cursor:pointer;box-shadow:0 0 25px #0f0;transition:.2s;letter-spacing:2px;border-radius:8px;min-height:50px;display:flex;align-items:center;justify-content:center;touch-action:manipulation;}
button:active {background:#0f0;color:#000;box-shadow:0 0 50px #0f0;transform:scale(0.95);}
button:disabled {opacity:0.4;}
.status {font-size:clamp(1.2rem,3.5vw,1.6rem);margin:15px 0;}
.char {background:rgba(0,30,0,0.8);padding:12px;margin:15px 0;border-left:4px solid #0f0;border-radius:8px;font-size:clamp(0.9rem,2.5vw,1.1rem);}
.level-bar, .health-bar {background:#111;border:1px solid #ff9500;padding:8px;margin:8px 0;border-radius:6px;}
.level-fill, .health-fill {height:20px;background:linear-gradient(90deg,#ff9500,#ffff00,#0f0);transition:width .3s;border-radius:3px;}
.health-fill {background:linear-gradient(90deg,#f66,#ff9500,#0f0);}
.gear-item {display:flex;justify-content:space-between;align-items:center;background:#111;padding:8px;margin:5px 0;border:1px solid #ff6200;border-radius:6px;font-size:0.85rem;}
.durability-bar {flex:1;margin:0 8px;max-width:120px;}
.durability-fill {height:12px;background:linear-gradient(90deg,#f66,#ff6200,#0f0);border-radius:2px;transition:width .3s;}
#mapContainer {flex:1;display:none;min-height:400px;position:relative;margin:10px 0;}
#map {height:100%;border:3px solid #0f0;box-shadow:0 0 30px #0f0;border-radius:12px;}
#nearby {position:absolute;top:10px;left:10px;right:10px;background:rgba(0,0,0,0.9);padding:12px;border:2px solid #ff9500;border-radius:8px;color:#ff9500;font-size:clamp(0.8rem,2vw,1rem);max-height:120px;overflow-y:auto;z-index:1000;}
.overlay {display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:9999;justify-content:center;align-items:center;flex-direction:column;color:#ff9500;padding:20px;}
.cratebox {width:280px;height:280px;max-width:90vw;max-height:90vh;background:#111;border:5px solid #ff6200;border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:clamp(3rem,12vw,5rem);animation:s 0.8s infinite;}
.raid-alert {background:#330000;border:4px solid #f66;padding:25px;border-radius:12px;text-align:center;max-width:90vw;max-height:80vh;overflow-y:auto;}
.combat-log {background:#111;padding:12px;margin:12px 0;border:1px solid #f66;border-radius:6px;max-height:150px;overflow-y:auto;font-size:0.85rem;line-height:1.3;}
.level-up {background:#001a00 !important;border:3px solid #0f0 !important;color:#0f0 !important;animation:levelGlow 1.5s infinite;}
.death-screen {background:#000;border:5px solid #f66;padding:30px;border-radius:15px;text-align:center;max-width:90vw;}
.stimpak-btn {background:#0f0 !important;color:#000 !important;border-color:#0f0 !important;}
@keyframes f {0%,100%{opacity:1}50%{opacity:0.6}}
@keyframes s {0%,100%{transform:translate(0)}25%{transform:translate(-8px,8px)rotate(-3deg)}75%{transform:translate(8px,-8px)rotate(3deg)}}
@keyframes levelGlow {0%,100%{box-shadow:0 0 30px #0f0}50%{box-shadow:0 0 60px #0f0,0 0 100px #ffff00}}
.leaflet-touch .leaflet-bar a {width:36px !important;height:36px !important;line-height:36px !important;}
.leaflet-touch .leaflet-control-zoom-in, .leaflet-touch .leaflet-control-zoom-out {font-size:18px !important;}
@media (max-width: 768px) {.term {padding:10px;margin:5px;border-radius:8px;border-width:2px;}}
</style>
</head>
<body>
<div class="term" id="mainContainer">
<h1>ATOMIC FIZZ</h1>
<p style="font-size:clamp(1.2rem,4vw,2rem);margin:15px 0;">‚öîÔ∏è 50 FALLOUT LOCATIONS + LEVELING</p>
<div style="background:rgba(0,40,0,0.7);padding:15px;margin:20px 0;border-left:4px solid #0f0;border-radius:8px;line-height:1.4;font-size:clamp(0.9rem,2.8vw,1.2rem);">
üéØ <b>50 LOCATIONS</b> ‚Üí üí∞ LOOT ‚Üí ‚öîÔ∏è FIGHT ‚Üí ‚≠ê LEVEL UP ‚Üí üí™ STRONGER
</div>
<button id="connectBtn">CONNECT WALLET</button>
<div class="status" id="status">Status: <span style="color:#f66;">NOT CONNECTED</span></div>
<div class="char" id="character" style="display:none;">
Wastelander: <span id="name">???</span> ‚Ä¢
<span id="levelDisplay" class="level-up">LVL <span id="lvl">1</span></span> ‚Ä¢
XP: <span id="xpText">0</span>/<span id="xpMax">100</span>
<div class="level-bar">
<div class="level-fill" id="xpBar" style="width:0%;"></div>
</div>
<div class="health-bar">
HP: <span id="hpText">100/100</span>
<div class="health-fill" id="hpBar" style="width:100%;"></div>
</div>
CAPS: <span id="caps">0</span>
</div>
<div class="gear-inventory" id="gearInventory" style="display:none;background:rgba(0,30,0,0.8);padding:15px;margin:15px 0;border-left:4px solid #ff6200;border-radius:8px;">
<h3 style="color:#ff6200;">‚öîÔ∏è GEAR</h3>
<div id="gearList"></div>
</div>
<div class="stimpak-shop" id="stimpakShop" style="display:none;background:rgba(0,30,0,0.8);padding:15px;margin:15px 0;border-left:4px solid #0f0;border-radius:8px;">
<h3 style="color:#0f0;">üíâ STIMPAK SHOP</h3>
<div style="display:flex;flex-wrap:wrap;gap:10px;justify-content:center;">
<button id="buyCommonStimpak" style="flex:1;min-width:120px;">Stimpak<br><span style="font-size:0.8em;">100 CAPS</span></button>
<button id="buyRareStimpak" style="flex:1;min-width:120px;">Super Stimpak<br><span style="font-size:0.8em;">500 CAPS</span></button>
</div>
<div id="stimpakInventory" style="margin-top:10px;"></div>
</div>
<button id="gpsBtn" disabled style="background:linear-gradient(45deg,#ff6200,#ff9500);border-color:#ff6200;color:#000;font-weight:700;">üéØ 50 LOCATION SCANNER</button>
<div id="mapContainer" style="display:none;"><div id="map"></div><div id="nearby"></div></div>
<button id="backBtn" onclick="backToMain()" style="display:none;background:linear-gradient(45deg,#f66,#ff9500);border-color:#f66;color:#000;font-weight:700;">üè† BACK TO TERMINAL</button>
</div>

<!-- OVERLAYS -->
<div class="overlay" id="lootOverlay">
<div class="cratebox">üí∞ LOOT!</div>
<h2 id="lootResult" style="margin:20px;font-size:clamp(1.2rem,5vw,2rem);">?</h2>
<button onclick="closeLoot()" style="margin-top:20px;">CONTINUE</button>
</div>
<div class="overlay" id="raidOverlay">
<div class="raid-alert">
<h2 id="enemyName" style="font-size:clamp(1.5rem,6vw,2.5rem);">üíÄ RAIDERS!</h2>
<p id="enemyStats" style="color:#ff9500;margin:10px 0;">25 ATK ‚Ä¢ 50 HP ‚Ä¢ 15 DEF</p>
<div class="combat-log" id="combatLog"></div>
<div style="display:flex;gap:15px;justify-content:center;margin:20px 0;flex-wrap:wrap;">
<button id="fightBtn" style="background:#0f0;color:#000;border-color:#0f0;min-width:120px;">‚öîÔ∏è FIGHT</button>
<button id="fleeBtn" style="border-color:#f66;color:#f66;min-width:120px;">üèÉ FLEE</button>
</div>
</div>
</div>
<div class="overlay" id="deathOverlay">
<div class="death-screen">
<div style="font-size:clamp(4rem,15vw,8rem);margin:15px;">‚ò†Ô∏è</div>
<h2 style="font-size:clamp(1.5rem,6vw,2.5rem);">YOU DIED</h2>
<p id="deathMessage" style="margin:15px 0;font-size:clamp(1rem,4vw,1.3rem);">Raiders destroyed you...</p>
<button class="stimpak-btn" id="reviveBtn" style="min-width:200px;font-size:1.3rem;">üíâ REVIVE WITH STIMPAK</button>
<p style="color:#f66;margin-top:15px;font-size:clamp(0.9rem,3vw,1.1rem);">No Stimpaks = PERMANENT DEATH</p>
</div>
</div>
<div class="overlay" id="levelUpOverlay">
<div style="background:#001a00;border:5px solid #0f0;padding:30px;border-radius:15px;text-align:center;max-width:90vw;">
<div style="font-size:clamp(4rem,15vw,8rem);margin:15px;">‚≠ê</div>
<h2 style="color:#0f0;font-size:clamp(1.5rem,6vw,2.5rem);">LEVEL UP!</h2>
<p style="font-size:clamp(1.2rem,5vw,2rem);margin:15px 0;">LVL <span id="newLevel">2</span></p>
<p style="color:#ff9500;font-size:clamp(1rem,4vw,1.3rem);">+20 HP ‚Ä¢ +5 ATK ‚Ä¢ +3 DEF</p>
<button onclick="closeLevelUp()" style="margin-top:20px;min-width:200px;">üí™ CONTINUE WASTELAND</button>
</div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
// üî• VARIABLES + 50 LOCATIONS
let map, userMarker, claimed = new Set(), playerState = {level:1,xp:0,maxHp:100,hp:100,gear:[],caps:0};
const falloutSpots = [{n:"Goodsprings (Pioneer Saloon)",lat:35.8324,lng:-115.4320},
      {n:"Primm (Buffalo Bill's)",lat:35.6145,lng:-115.3845},
      {n:"Nipton Trading Post",lat:35.46667,lng:-115.27222},
      {n:"Boulder City Hotel",lat:35.97750,lng:-114.83639},
      {n:"Hoover Dam",lat:36.016045,lng:-114.737839},
      {n:"Lucky 38 (The Strat)",lat:36.147247,lng:-115.156029},
      {n:"New Vegas Strip (Bellagio)",lat:36.112740,lng:-115.174301},
      {n:"Freeside (Fremont St)",lat:36.170719,lng:-115.143929},
      {n:"Red Rock Canyon",lat:36.13514,lng:-115.4283},
      {n:"Bonnie Springs Ranch",lat:36.06007,lng:-115.45027},
      {n:"Callville Bay Marina",lat:36.14400,lng:-114.72200},
      {n:"Black Mountain",lat:35.9310,lng:-115.0440},
      {n:"Sloan Station",lat:35.94361,lng:-115.21722},
      {n:"Jean Airport",lat:35.7677,lng:-115.3245},
      {n:"Searchlight",lat:35.46434,lng:-114.91844},
      {n:"McCarran Airport",lat:36.0801,lng:-115.1522},
      {n:"Nellis AFB",lat:36.2361,lng:-115.0342},
      {n:"Helios One (Nevada Solar One)",lat:35.7580,lng:-114.9530},
      {n:"Old Mormon Fort",lat:36.1694,lng:-115.1305},
      {n:"Ultra-Luxe (Caesars Palace)",lat:36.0972,lng:-115.1787},
      {n:"Gomorrah (Dunes site)",lat:36.1100,lng:-115.1720},
      {n:"Silver Rush (Golden Nugget)",lat:36.1498,lng:-115.1390},
      {n:"Atomic Wrangler (Vegas Vic)",lat:36.1499,lng:-115.1383},
      {n:"Repconn Test Site (Pepcon)",lat:36.0360,lng:-115.0880},
      {n:"Novac (Little A'Le'Inn)",lat:37.6447,lng:-115.7461},
      {n:"Nelson Ghost Town",lat:35.4189,lng:-114.7133},
      {n:"Rhyolite Ghost Town",lat:36.9033,lng:-116.8283},
      {n:"Mt. Charleston",lat:36.2650,lng:-115.6500},
      {n:"Luxor Pyramid",lat:36.0965,lng:-115.1769},
      {n:"Whiskey Pete's",lat:35.6167,lng:-115.3900},
      {n:"Primm Valley Resort",lat:35.6160,lng:-115.3900},
      {n:"Westgate (Vault 21)",lat:36.1311,lng:-115.1564},
      {n:"Coca Cola Store",lat:36.1025,lng:-115.1738},
      {n:"Nellis Solar Array",lat:36.2460,lng:-115.0320},
      {n:"Ivanpah Solar",lat:35.2000,lng:-115.4667},
      {n:"Cottonwood Cove",lat:35.9990,lng:-114.5000},
      {n:"Vault 34 (Lake Mead)",lat:36.1750,lng:-114.7500},
      {n:"Jacobstown",lat:36.3000,lng:-115.6500},
      {n:"Dead Wind Cavern",lat:35.8000,lng:-115.4000},
      {n:"REPCONN Headquarters",lat:36.0500,lng:-115.1000},
      {n:"188 Trading Post",lat:35.9500,lng:-115.2000},
      {n:"Griffin Wares Caravan",lat:35.9000,lng:-115.2500},
      {n:"Nevada Highway Patrol",lat:35.9500,lng:-115.1500},
      {n:"Sunset Sarsaparilla HQ",lat:36.0000,lng:-115.2000},
      {n:"HELIOS One Entrance",lat:35.7600,lng:-114.9500},
      {n:"Camp Searchlight Church",lat:35.4600,lng:-114.9200},
      {n:"Quarry Junction",lat:35.9200,lng:-115.1800},
      {n:"Vikki & Vance Museum",lat:35.6150,lng:-115.3850},
      {n:"Mesquite Mountains",lat:35.8500,lng:-115.9500},
      {n:"Devil's Gullet",lat:35.7000,lng:-115.3000}
      ];

// üî• 
function loadPlayerState() {
  playerState = {level:1,xp:0,xpToNext:100,maxHp:100,hp:100,gear:[],stimpaks:[],caps:0};
  updateUI();
}
function updateUI() {
  document.getElementById("lvl").textContent = playerState.level;
  document.getElementById("xpText").textContent = playerState.xp;
  document.getElementById("xpMax").textContent = playerState.xpToNext;
  document.getElementById("xpBar").style.width = "0%";
  document.getElementById("hpText").textContent = `${playerState.hp}/${playerState.maxHp}`;
  document.getElementById("hpBar").style.width = "100%";
  document.getElementById("caps").textContent = playerState.caps||0;
  document.getElementById("gearList").innerHTML = '<p style="color:#f66;">NO GEAR ‚Äì LOOT NOW!</p>';
  document.getElementById("stimpakInventory").innerHTML = '<p style="color:#f66;">NO STIMPAKS</p>';
}
function claimLoot(spotName) {
  alert(`üéØ LOOTED ${spotName}! +50 CAPS`);
  playerState.caps += 50;
  updateUI();
  claimed.add(spotName);
}
function closeLoot() { document.getElementById("lootOverlay").style.display = "none"; }
function closeLevelUp() { document.getElementById("levelUpOverlay").style.display = "none"; }

// üî• SCANNER BUTTON (YOUR CODE)
document.getElementById("gpsBtn").onclick = () => {
  document.getElementById("mainContainer").style.display = "none";
  document.getElementById("mapContainer").style.display = "block";
  document.getElementById("backBtn").style.display = "block";
  
  map = L.map('map').setView([36.1146, -115.1728], 10);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
  
  // ADD MARKERS
  falloutSpots.forEach(spot => {
    L.circleMarker([spot.lat,spot.lng], {radius:8,color:'#ff6200',fillColor:'#ff6200',fillOpacity:0.8})
    .addTo(map)
    .bindPopup(spot.n)
    .on('click', () => {
      map.setView([spot.lat,spot.lng], 16);
      claimLoot(spot.n);
    });
  });
  
  userMarker = L.circleMarker([36.1146, -115.1728], {radius:12,color:'#0f0',fillColor:'#0f0'}).addTo(map).bindPopup("üü¢ YOU");
  
  document.getElementById("nearby").innerHTML = `üéØ <b>${falloutSpots.length} LOOT SPOTS LOADED!</b><br>üëÜ <b>TAP ORANGE DOTS</b>`;
  alert(`üó∫Ô∏è RADIATION SCANNER ACTIVE!\n‚úÖ ${falloutSpots.length} LOCATIONS\nüü¢=You | üü†=Loot`);
};

// üî• CONNECT BUTTON
// ‚úÖ DUAL WALLET: ETH + SOL + TEST MODE
document.getElementById("connectBtn").onclick = async () => {
  let connected = false;
  let walletType = "TEST MODE";
  
  // üî• TRY ETHEREUM FIRST (80% of players)
  if (window.ethereum) {
    try {
      const accounts = await window.ethereum.request({ 
        method: 'eth_requestAccounts' 
      });
      wallet = `ETH:${accounts[0]}`;
      walletType = "ETHEREUM";
      document.getElementById("status").innerHTML = `
        <span style="color:#0f0;">‚úÖ ETH ${accounts[0].slice(0,6)}...${accounts[0].slice(-4)}</span>
      `;
      connected = true;
    } catch (e) {
      console.log("ETH failed, trying Solana...");
    }
  }
  
  // üî• TRY SOLANA SECOND (15% of players)  
  if (!connected && window.solana) {
    try {
      const resp = await window.solana.connect();
      wallet = `SOL:${resp.publicKey.toString()}`;
      walletType = "SOLANA";
      document.getElementById("status").innerHTML = `
        <span style="color:#0f0;">‚úÖ SOL ${resp.publicKey.toString().slice(0,6)}...${resp.publicKey.toString().slice(-4)}</span>
      `;
      connected = true;
    } catch (e) {
      console.log("SOL failed, using test mode...");
    }
  }
  
  // üî• TEST MODE (5% no wallets)
  if (!connected) {
    wallet = "MOBILE_" + Date.now();
    walletType = "TEST MODE";
    document.getElementById("status").innerHTML = `<span style="color:#0f0;">‚úÖ TEST MODE</span>`;
  }
  
  // üî• UNLOCK GAME FOR EVERYONE
  document.getElementById("connectBtn").textContent = "‚úÖ CONNECTED";
  document.getElementById("connectBtn").disabled = true;
  document.getElementById("gpsBtn").disabled = false;
  document.getElementById("character").style.display = "block";
  document.getElementById("gearInventory").style.display = "block";
  document.getElementById("stimpakShop").style.display = "block";
  loadPlayerState();
  
  alert(`‚úÖ ${walletType} ACTIVE!\nüéØ ${falloutSpots.length} LOCATIONS READY!`);
};

// üî• BACK BUTTON
function backToMain() {
  document.getElementById("mapContainer").style.display = "none";
  document.getElementById("backBtn").style.display = "none";
  document.getElementById("mainContainer").style.display = "flex";
  if(map) { map.remove(); map = null; }
}

// üíâ STIMPAK PAYMENTS (ETH + SOL + FREE)
document.getElementById("buyCommonStimpak").onclick = async () => {
  if (wallet && (wallet.startsWith('ETH:') || wallet.startsWith('SOL:'))) {
    alert("üíé REAL PAYMENTS COMING SOON!\nüéÆ FREE stimpaks for LAUNCH WEEK!");
  }
  
  if (playerState.caps >= 100) {
    playerState.caps -= 100;
    playerState.stimpaks.push({name:"Stimpak"});
    updateUI();
    alert("üíâ Stimpak purchased!\n‚ö° Ready for revival!");
  } else {
    alert("‚ùå Need 100 CAPS\nüéØ LOOT MORE LOCATIONS!");
  }
};

// üíâ SUPER STIMPAK
document.getElementById("buyRareStimpak").onclick = async () => {
  if (wallet && (wallet.startsWith('ETH:') || wallet.startsWith('SOL:'))) {
    alert("üíé SUPER STIMPAK = $10 COMING SOON!\nüéÆ FREE for LAUNCH!");
  }
  
  if (playerState.caps >= 500) {
    playerState.caps -= 500;
    playerState.stimpaks.push({name:"Super Stimpak"});
    updateUI();
    alert("üíâ SUPER Stimpak purchased!\n‚ö° FULL HP + Gear Repair!");
  } else {
    alert("‚ùå Need 500 CAPS\nüí∞ LOOT BIGGER SPOTS!");
  }
};

// üíâ REVIVE BUTTON
document.getElementById("reviveBtn").onclick = () => {
  if (playerState.stimpaks.length > 0) {
    const stimpak = playerState.stimpaks.shift();
    playerState.hp = stimpak.name.includes('Super') ? playerState.maxHp : Math.min(playerState.maxHp, playerState.hp + 60);
    document.getElementById("deathOverlay").style.display = "none";
    updateUI();
    alert(`üíâ REVIVED with ${stimpak.name}!`);
  } else {
    alert("‚ùå NO STIMPAKS!\nüíÄ PERMANENT DEATH");
    location.reload(); // Restart game
  }
};

// üî• FIGHT & FLEE BUTTONS
document.getElementById("fightBtn").onclick = () => {
  alert("‚öîÔ∏è COMBAT COMING SOON!\nüéÆ LOOT MORE FOR NOW!");
};

document.getElementById("fleeBtn").onclick = () => {
  document.getElementById("raidOverlay").style.display = "none";
  alert("üèÉ Fled from combat!");
};
</script>
</body>
</html>
